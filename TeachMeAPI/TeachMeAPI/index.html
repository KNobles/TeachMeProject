<!DOCTYPE html>
<html>
<head>
    <title>SignalR Simple Chat</title>
    <style type="text/css">
        .container {
            background-color: #99CCFF;
            border: solid #808080;
            padding: 20px;
            margin: 20px;
        }
    </style>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
</head>
<body>
    <div class="container-fluid">
        <input type="hidden" id="displayname" />
        <input type="text" id="title" />
        <select id="selector">
            <option id="math">Math</option>
            <option id="compta">Comptabilité</option>
            <option id="eco">Economie</option>
        </select>
        <br />
        <textarea id="description" rows="10" cols="40"></textarea>
        <input type="button" class="btn btn-success" id="sendannounce" value="Create" />

        <div id="announce" class="container-fluid"></div>
    </div>
    <!--Script references. -->
    <!--Reference the jQuery library. -->
    <script src="Scripts/jquery-1.6.4.min.js"></script>
    <!--Reference the SignalR library. -->
    <script src="Scripts/jquery.signalR-2.3.0.min.js"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="signalr/hubs"></script>

    <!--Add script to update the page and send messages.-->
    <script type="text/javascript">
        $(function () {
            // Declare a proxy to reference the hub.
            var chat = $.connection.chatHub;
            // Create a function that the hub can call to broadcast messages.

            chat.client.broadcastAnnouncement = function (username, title, course, description) {
                console.log(arguments);
                console.log(description);
                // Html encode display name and message.
                var encodedUsername = $('<div />').text(username).html();
                var encodedTitle = $('<div />').text(title).html();
                var encodedCourse = $('<div />').text(course).html();
                var encodedDescription = $('<div />').text(description).html();
                // Add the message to the page.
                $('#announce').append('<div class="container"><div class="row align-items-start" style="background-color:white;"><div class="col">' + encodedUsername
                    + '</div><div class="col">' + encodedTitle + '</div><div class="col">' + encodedCourse + '</div></div><div>'
                    + encodedDescription + '</div></div>');
            }


            // Get the user name and store it to prepend to messages.
            $('#displayname').val(prompt('Enter your name:', ''));

            // Set initial focus to message input box.
            $('#description').focus();

            // Start the connection.
            $.connection.hub.start().done(function () {
                $('#sendannounce').click(function () {
                    // Call the Send method on the hub.
                    //chat.server.send($('#displayname').val(), $('#message').val());
                    chat.server.createAnnouncemement($('#displayname').val(), $('#title').val()
                        , $('#selector').val(), $('#description').val());
                    // Clear text box and reset focus for next comment.
                    $('#title').val('').focus();
                    $('#selector').val('');
                    $('#description').val('');
                });
            });


        });
    </script>
</body>
</html>